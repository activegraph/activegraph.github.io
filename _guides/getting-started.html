<!doctype html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Getting Started with ActiveGraph - ActiveGraph Guides</title>
  <link rel="stylesheet" href="/assets/css/main.css"></link>
</head>
<body><div class="Header flex-justify-center">
  <div class="Header-item">
    <a class="Header-link" href="/">Guides</a>
  </div>
  <div class="Header-item">
    <a class="Header-link" href="https://pkg.go.dev/github.com/activegraph/activegraph">Documentation</a>
  </div>
</div>
<div class="flash flash-full">
      <div class="margin-auto col-md-11 col-lg-7">
        <h3 class="pb-2">Getting Started with ActiveGraph</h3>
        
        <p><svg class="octicon octicon-check-circle text-green" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0zM0 8a8 8 0 1116 0A8 8 0 010 8zm11.78-1.72a.75.75 0 00-1.06-1.06L6.75 9.19 5.28 7.72a.75.75 0 00-1.06 1.06l2 2a.75.75 0 001.06 0l4.5-4.5z"></path></svg>How to install ActiveGraph, create a new ActiveGraph application.</p>
        
        <p><svg class="octicon octicon-check-circle text-green" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M1.5 8a6.5 6.5 0 1113 0 6.5 6.5 0 01-13 0zM0 8a8 8 0 1116 0A8 8 0 010 8zm11.78-1.72a.75.75 0 00-1.06-1.06L6.75 9.19 5.28 7.72a.75.75 0 00-1.06 1.06l2 2a.75.75 0 001.06 0l4.5-4.5z"></path></svg>How to quickly generate the starting pieces of an ActiveGraph application.</p>
        
      </div>
    </div>
    <main class="margin-auto col-md-11 col-lg-7 d-md-flex flex-row-reverse flex-justify-center flex-row">
      <div class="flex-shrink-0 m-3">
        <h3>Chapters</h3>
        <ol id="toc" class="section-nav">
<li class="toc-entry toc-h2"><a href="#1-define-a-new-model-type">1 Define a new model type</a></li>
<li class="toc-entry toc-h2"><a href="#2-define-function-to-query-posts">2 Define function to query posts</a></li>
<li class="toc-entry toc-h2"><a href="#3-configure-a-server">3 Configure a server</a></li>
<li class="toc-entry toc-h2"><a href="#4-start-the-server">4 Start the server</a></li>
</ol>
      </div>
      <div class="flex-1 m-3">
        <blockquote>
  <p>This tutorial is a step-by-step guide of building simple API server. If youâ€™re
just getting started with GraphQL, we recommend going through <a href="https://graphql.org/learn">the GraphQL overview</a>.</p>
</blockquote>

<h2 id="1-define-a-new-model-type">1 Define a new model type</h2>

<p>Unlike other GraphQL frameworks, <strong>Resly</strong> does not forces to write GraphQL
schema separately from the Go types. JSON tags for each field of the Go type are
used to define names for GraphQL type fields.</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">Post</span> <span class="k">struct</span> <span class="p">{</span>
    <span class="n">ID</span>       <span class="kt">string</span> <span class="s">`json:"id"`</span>
    <span class="n">AuthorID</span> <span class="kt">string</span> <span class="s">`json:"author_id"`</span>
    <span class="n">Text</span>     <span class="kt">string</span> <span class="s">`json:"text"`</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">Post</code> type above generates the following GraphQL schema:</p>
<div class="language-graphql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span><span class="w"> </span><span class="n">Post</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">id</span><span class="p">:</span><span class="w">        </span><span class="nb">String</span><span class="p">!</span><span class="w">
  </span><span class="n">author_id</span><span class="p">:</span><span class="w"> </span><span class="nb">String</span><span class="p">!</span><span class="w">
  </span><span class="n">text</span><span class="p">:</span><span class="w">      </span><span class="nb">String</span><span class="p">!</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Unless you define field type as a pointer, it will generate <em>required</em> field.</p>

<h2 id="2-define-function-to-query-posts">2 Define function to query posts</h2>

<p>You can use existing functions to retrieve data from the the database, as long
as <strong>Resly</strong> does not inject any depenencies into the client code.</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">func</span> <span class="n">queryPosts</span><span class="p">(</span><span class="n">ctx</span> <span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">)</span> <span class="p">([]</span><span class="n">Post</span><span class="p">,</span> <span class="kt">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">posts</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">db</span><span class="o">.</span><span class="n">Query</span><span class="p">(</span><span class="n">ctx</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">posts</span><span class="p">,</span> <span class="n">err</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="3-configure-a-server">3 Configure a server</h2>

<p>The next step groups all components together, it connects types to the queries
used to retrieve them.</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="n">s</span> <span class="o">=</span> <span class="n">resly</span><span class="o">.</span><span class="n">Server</span> <span class="p">{</span>
    <span class="n">TypeDefs</span><span class="o">:</span> <span class="p">[]</span><span class="n">resly</span><span class="o">.</span><span class="n">TypeDef</span><span class="p">{</span>
        <span class="c">// Register the GraphQL type called "Post".</span>
        <span class="n">resly</span><span class="o">.</span><span class="n">NewType</span><span class="p">(</span><span class="n">Post</span><span class="p">{},</span> <span class="no">nil</span><span class="p">),</span>
    <span class="p">},</span>
    <span class="n">Queries</span><span class="o">:</span> <span class="p">[]</span><span class="n">resly</span><span class="o">.</span><span class="n">FuncDef</span><span class="p">{</span>
        <span class="c">// Register query to retrieve a list of posts.</span>
        <span class="n">resly</span><span class="o">.</span><span class="n">NewFunc</span><span class="p">(</span><span class="s">"posts"</span><span class="p">,</span> <span class="n">queryPosts</span><span class="p">),</span>
    <span class="p">},</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="4-start-the-server">4 Start the server</h2>

<p>On the last step simply run the configured GraphQL server as HTTP server.</p>

<div class="language-go highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="s">"net/http"</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">http</span><span class="o">.</span><span class="n">Handle</span><span class="p">(</span><span class="s">"/graphql"</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
    <span class="n">http</span><span class="o">.</span><span class="n">ListenAndServe</span><span class="p">(</span><span class="s">":8000"</span><span class="p">,</span> <span class="no">nil</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

      </div>
    </main>
  </body>
</html>
